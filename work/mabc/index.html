<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>Journal Recreation: Approximate Bayesian computation for disease outbreaks :: Joe Stoica</title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="This post is a summary of the final project that I completed for my Statistical Computing course in my first semester of grad school. The goal of this project was to recreate two figures from a paper authored by Tony and Stumpf, “Simulation-based model selection for dynamical systems in systems and population biology”(which can be found here). This paper uses the approximate bayesian computation (or ABC) algorithm to model a few fairly complex statistical models."/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="http://joestoica.com/work/mabc/" />





<link rel="stylesheet" href="http://joestoica.com/assets/style.css">


<link rel="stylesheet" href="http://joestoica.com/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://joestoica.com/img/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="http://joestoica.com/img/favicon.png">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Journal Recreation: Approximate Bayesian computation for disease outbreaks"/>
<meta name="twitter:description" content="This post is a summary of the final project that I completed for my Statistical Computing course in my first semester of grad school. The goal of this project was to recreate two figures from a paper authored by Tony and Stumpf, “Simulation-based model selection for dynamical systems in systems and population biology”(which can be found here). This paper uses the approximate bayesian computation (or ABC) algorithm to model a few fairly complex statistical models."/>



<meta property="og:title" content="Journal Recreation: Approximate Bayesian computation for disease outbreaks" />
<meta property="og:description" content="This post is a summary of the final project that I completed for my Statistical Computing course in my first semester of grad school. The goal of this project was to recreate two figures from a paper authored by Tony and Stumpf, “Simulation-based model selection for dynamical systems in systems and population biology”(which can be found here). This paper uses the approximate bayesian computation (or ABC) algorithm to model a few fairly complex statistical models." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://joestoica.com/work/mabc/" />
<meta property="article:published_time" content="2020-03-28T12:27:13-05:00" />
<meta property="article:modified_time" content="2020-03-28T12:27:13-05:00" /><meta property="og:site_name" content="Joe Stoica" />






  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a href="/about" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">Joe Stoica</span>
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/now">Now</a></li>
        
      
        
          <li><a href="/work">Work</a></li>
        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/now">Now</a></li>
      
    
      
        <li><a href="/work">Work</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <div class="post">
    <h2 class="post-title"><a href="http://joestoica.com/work/mabc/">Journal Recreation: Approximate Bayesian computation for disease outbreaks</a></h2>
    <div class="post-meta">
      
        <span class="post-date">
          2020-03-28
        </span>

        
          
        
      

      
      
    </div>

    
      <span class="post-tags">
        
          #<a href="http://joestoica.com/tags/statistics/">statistics</a>&nbsp;
        
          #<a href="http://joestoica.com/tags/projects/">projects</a>&nbsp;
        
      </span>
    

    

    <div class="post-content">
      <p>This post is a summary of the final project that I completed for my Statistical Computing course in my first semester of grad school. The goal of this project was to recreate two figures from a paper authored by Tony and Stumpf, “Simulation-based model selection for dynamical systems in systems and population biology”(which can be found <a href="https://academic.oup.com/bioinformatics/article/26/1/104/182571">here</a>). This paper uses the approximate bayesian computation (or ABC) algorithm to model a few fairly complex statistical models. The model which we replicated is involved in applying ABC to compare difference in the transmission pattern for strains of influenza viruses.</p>
<p>The questions of Tony and Stumpf&rsquo;s original analysis was to see &ldquo;&hellip; whether (i) different outbreaks of the same strain and (ii) outbreaks of differentmolecular strains of the influenza virus can be described by the same model of disease spread.&rdquo;  In this post, I&rsquo;ll give a quick summary of how ABC works, and how my group went about implementing the algorithm to match the original authors&rsquo; results. (Quick disclaimer, I would like to give complete and utter credit to the original authors and let it be known that this is their original work!)</p>
<h2 id="understanding-the-data">Understanding the data</h2>
<p>In order to better explain the algorithm, I first want to describe some more specifics about the project. One half of this data comes from two outbreaks of the same virus, with one occuring in Michigan in 1978-1979 and one in Michigan in 1980-1981. We will refer to this as data table A. The second outbreak is two different viruses from two different time points. All of this data is arranged in a table, which tells you how many people were infected out the potential number of people infected, and this will referred to as  table B. Using this data, we will apply ABC to see answer the questions above, which is done in a fairly elegant way (which will be described below!).</p>
<h2 id="the-abc-algorithm">The ABC algorithm</h2>
<p>ABC is a seemingly magical algorithm that allows for the calculation of parameters that belong to a distribution (which is referred to as the posterior distribution). We can calculate these parameters using a specified prior distribution (which is where the initial parameters for our data came from), and the data we have regarding the influenza outbreaks. We now have most of the pieces, so here&rsquo;s how we&rsquo;ll put them together:</p>
<p>We begin by drawing parameters from our prior distribution. For this model, the authors specified a uniform distribution (or simply, four independent random numbers between 0 and 1) for each of the four parameters. One pair of parameters will belong to the first member of the viral outbreak pair. For example, if we were generating data to match data table A, we use the first two parameters to create data for the outbreak pertaining to 1978-1979, and the second two parameters for 1980-1981.</p>
<p>Once we have the pairs of parameters, we plug them into a data generating function that will generate a data matrix (we&rsquo;ll call that matrix $w$ that comes from the same probability model that our original data came from), which is: $$w_{js} = {s\choose j}w_{jj}(q_cq_h^j)^{s-j}$$ This looks confusing, and it is. The main takeaway is that $j$ represents the number of people infected out of a total number of $s$ people. $w_{jj}$ is the jth diagonal element in the data matrix that we are currently generating. $q_c$ and $q_h$ are the probabilities that someone is infected from their community and infected from their household respectively. To build this data, we began by creating the first row, which is specified in the paper by $w_{0s} = q_c^s$. The diagonal of $w$ is created using $w_{jj} = 1 - \sum_{i=0}^{j-1}w_{ij}$. The rest of the data was then created iteratively across each row of the matrix using the first equation for $w_{js}$ and calculating $wjj$ for each diagonal element.</p>
<p>Now that we have the data generated, we need to create a way to measure whether the data we have generated is similar to the original data that we have. The authors did this by creating a distance metric which compares the two generated data sets to their respective original dat set using this formula: $$d(D_0,D^{<em>})=\frac{1}{2}(||D_1 - D^</em>(q_{h1},q_{c1})||_F+||D_2 -D^*(q_{h2},q_{c2})||_F)$$ where $||A||_F = \sqrt{trace(A^TA)}$ denotes the frobenious norm, and $D^*$ is a matrix generated using the parameters from our prior. If this distance is smaller than some specified tolerance, than those parameters that were used to generate the data are deemed appropriate and accepted. For each data table, we replicated this process 1000 times, meaning that we have two dataframes with 1000 rows and 4 columns each, and contains the accepted parameters for each simulation.</p>
<p>And that is how the authors implemented ABC for model selection for this certain problem. I do want to mention though, the authors actually did use a modified version of ABC referred to as ABC SMC, which is a way to speed up the ABC process by giving a tolerance schedule for accepting parameters, not just one single tolerance. However, in this class we did not learn nor need to implement ABC SMC for our project, so that is the only difference between the authors results and our results. This will not actually affect our results, only how long it takes for us to get them.</p>
<h2 id="results">Results</h2>
<p>The goal of this project was to replicate the authors figures, and we did. Here are our recreated figures:</p>
<p><img src="/images/res1.png" alt="The first recreated figure"></p>
<p>You can see that the results from this figure matches the paper&rsquo;s findings. The conclusion from the figure is clear: we can see that their is a significant amount of overlap between both of the clusters. This means that the accepted parameters for both of the outbreaks are similar, which indicates that their transmission patterns are similar to one another.</p>
<p><img src="/images/res2.png" alt="The second recreated figure"></p>
<p>And the results from the second simulation show us the opposite. Since these clusters have no overlap, the two different strains from the two different years do not have the same transmission patterns. Super cool!</p>
<p>I hope you enjoyed learning a little bit about ABC and how powerful and interesting it is. I really hope I&rsquo;ll be able to a similar project sometime in the near future!</p>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h">Read other posts</span>
            <hr />
          </div>
          <div class="pagination__buttons">
            
              <span class="button previous">
                <a href="http://joestoica.com/work/college_finances/">
                  <span class="button__icon">←</span>
                  <span class="button__text">Productive College Life I: Finance</span>
                </a>
              </span>
            
            
              <span class="button next">
                <a href="http://joestoica.com/work/xkcd/">
                  <span class="button__text">Viewing xkcd comics in RStudio</span>
                  <span class="button__icon">→</span>
                </a>
              </span>
            
          </div>
        </div>
      
    


    
      
        

      
    

    </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user"> </div>
    
  </div>
</footer>

<script src="http://joestoica.com/assets/main.js"></script>
<script src="http://joestoica.com/assets/prism.js"></script>


      
    </div>

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-162218966-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
  </body>
</html>
